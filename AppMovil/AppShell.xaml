<?xml version="1.0" encoding="UTF-8" ?>
<Shell
    x:Class="AppMovil.AppShell"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:AppMovil"
    xmlns:viewModels="clr-namespace:AppMovil.ViewModels"
    Shell.FlyoutBehavior="Disabled"
    Title="Biblioteca Digital">

    <Shell.BindingContext>
        <viewModels:AppShellViewModel x:Name="AppShellVM"/>
    </Shell.BindingContext>

    <!-- Header del Flyout personalizado -->
    <Shell.FlyoutHeader>
        <Grid BackgroundColor="#2196F3" HeightRequest="120">
            <StackLayout VerticalOptions="Center" HorizontalOptions="Center">
                <Label Text="📚" FontSize="40" HorizontalOptions="Center" TextColor="White"/>
                <Label Text="Biblioteca Digital" FontSize="18" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center"/>
            </StackLayout>
        </Grid>
    </Shell.FlyoutHeader>

    <!-- Pantalla de Login -->
    <ShellContent
        Title="Login"
        ContentTemplate="{DataTemplate local:LoginPage}"
        Route="LoginPage"
        IsVisible="{Binding LoginVisible}"
        FlyoutItemIsVisible="False" />

    <!-- Menu Principal - Solo visible cuando está logueado -->
    <FlyoutItem Title="🏠 Inicio" Icon="home.png" IsVisible="{Binding MenuVisible}">
        <ShellContent
            Title="Dashboard"
            ContentTemplate="{DataTemplate local:MainPage}"
            Route="MainPage" />
    </FlyoutItem>

    <FlyoutItem Title="📖 Buscar Libros" Icon="search.png" IsVisible="{Binding MenuVisible}">
        <ShellContent
            Title="Buscar Libros"
            ContentTemplate="{DataTemplate local:BuscarLibrosPage}"
            Route="BuscarLibrosPage" />
    </FlyoutItem>

    <FlyoutItem Title="📋 Mis Prestamos" Icon="book.png" IsVisible="{Binding MenuVisible}">
        <ShellContent
            Title="Prestamos"
            ContentTemplate="{DataTemplate local:PrestamosPage}"
            Route="PrestamosPage" />
    </FlyoutItem>

    <FlyoutItem Title="↩️ Devoluciones" Icon="return.png" IsVisible="{Binding MenuVisible}">
        <ShellContent
            Title="Devoluciones"
            ContentTemplate="{DataTemplate local:DevolucionesPage}"
            Route="DevolucionesPage" />
    </FlyoutItem>

    <!-- Footer del Flyout con opción de logout -->
    <Shell.FlyoutFooter>
        <StackLayout IsVisible="{Binding MenuVisible}" BackgroundColor="#F5F5F5" Padding="10">
            <Button 
                Text="🚪 Cerrar Sesion" 
                BackgroundColor="#F44336" 
                TextColor="White"
                Command="{Binding LogoutCommand}"
                CornerRadius="5"/>
        </StackLayout>
    </Shell.FlyoutFooter>

</Shell>
